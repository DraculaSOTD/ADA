<div class="generate-predictions-container">
    <div class="finalization-page">
        <div class="page-header">
            <h1 class="page-title">Model Editor</h1>
            <p class="page-subtitle">Design, configure, and train custom AI models</p>
            <div class="model-selector-container">
                <div class="custom-dropdown">
                    <input type="text" id="model-search" class="model-search" placeholder="Search or select a model...">
                    <div id="model-options" class="model-options" style="display: none;">
                        <!-- Options will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Disclaimer at the top -->
        <div class="disclaimer card">
            <h3>Disclaimer:</h3>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi ultricies ligula eget eros tristique accumsan. Duis diam velit, sagittis quis ipsum ut, tempor pharetra erat. Fusce a pretium tortor.</p>
        </div>
        
        <div class="form-section">
            <div class="form-row">
                <div class="form-group">
                    <label for="model-name">Model Name:</label>
                    <input type="text" id="model-name" placeholder="TextField">
                </div>
                <div class="form-group large-input">
                    <label for="model-description">Model Description:</label>
                    <textarea id="model-description" placeholder="TextField"></textarea>
                </div>
            </div>


            <div class="form-row">
                <div class="form-group">
                    <label for="model-algorithm">ML Algorithm:</label>
                    <select id="model-algorithm" class="algorithm-dropdown">
                        <option value="">Select an algorithm...</option>
                        <optgroup label="Classification">
                            <option value="random_forest_clf">Random Forest</option>
                            <option value="svm_clf">Support Vector Machine (SVM)</option>
                            <option value="logistic_regression">Logistic Regression</option>
                            <option value="neural_network_clf">Neural Network</option>
                            <option value="xgboost_clf">XGBoost</option>
                            <option value="decision_tree_clf">Decision Tree</option>
                            <option value="naive_bayes">Naive Bayes</option>
                            <option value="knn_clf">K-Nearest Neighbors</option>
                        </optgroup>
                        <optgroup label="Regression">
                            <option value="linear_regression">Linear Regression</option>
                            <option value="polynomial_regression">Polynomial Regression</option>
                            <option value="ridge_regression">Ridge Regression</option>
                            <option value="lasso_regression">Lasso Regression</option>
                            <option value="random_forest_reg">Random Forest Regressor</option>
                            <option value="neural_network_reg">Neural Network Regressor</option>
                            <option value="svm_reg">Support Vector Regressor</option>
                            <option value="xgboost_reg">XGBoost Regressor</option>
                        </optgroup>
                        <optgroup label="Clustering">
                            <option value="kmeans">K-Means</option>
                            <option value="dbscan">DBSCAN</option>
                            <option value="hierarchical">Hierarchical Clustering</option>
                            <option value="gaussian_mixture">Gaussian Mixture Model</option>
                            <option value="mean_shift">Mean Shift</option>
                        </optgroup>
                        <optgroup label="Time Series">
                            <option value="arima">ARIMA</option>
                            <option value="lstm">LSTM</option>
                            <option value="prophet">Prophet</option>
                            <option value="seasonal_decompose">Seasonal Decomposition</option>
                        </optgroup>
                        <optgroup label="NLP">
                            <option value="bert">BERT</option>
                            <option value="gpt">GPT</option>
                            <option value="sentiment_analysis">Sentiment Analysis</option>
                            <option value="text_classification">Text Classification</option>
                            <option value="named_entity_recognition">Named Entity Recognition</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group">
                    <label for="epoch">Epochs:</label>
                    <input type="number" id="epoch" placeholder="10" min="1" max="1000">
                </div>
            </div>

            <div class="form-row" id="algorithm-params-row">
                <div class="form-group">
                    <label for="hidden-layers">Hidden Layers:</label>
                    <input type="number" id="hidden-layers" placeholder="2" min="1" max="10">
                </div>
                <div class="form-group">
                    <label for="batch-size">Batch Size:</label>
                    <input type="number" id="batch-size" placeholder="32" min="1" max="512">
                </div>
            </div>
        </div>

        <div class="uploaded-data card">
            <h3>Upload Data:</h3>
            <div class="data-row">
                <input type="file" id="csv-upload" accept=".csv,.xlsx,.xls,.json" style="display: none;" multiple>
                <label for="csv-upload" class="upload-label">Choose File</label>
                <span id="file-name">No file chosen</span>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
                <span id="upload-status"></span>
                <span id="eta"></span>
                <button id="upload-button" class="upload-button">Upload</button>
                <button id="clear-file-btn" class="clear-file-btn" style="display: none;" onclick="if (window.clearFile) window.clearFile(); else console.error('clearFile not loaded yet');">
                    <i class="fas fa-times"></i> Clear File
                </button>
            </div>
        </div>

        <div class="tagged-data card">
            <h3>Tagged Data:</h3>
            <div id="tagged-data-content" class="tagged-data-content">
                <div class="placeholder-message">
                    <i class="fas fa-database"></i>
                    <p>Select a model and upload data to configure column mappings</p>
                </div>
            </div>
        </div>
        <div class="tagged-data card">
            <h3>Test Data Configuration:</h3>
            <div class="form-row test-config-row">
                <div class="form-group test-size-group">
                    <label for="testing-data-size">Testing Data Size:</label>
                    <div class="test-input-group">
                        <input type="number" id="testing-data-size" placeholder="20" min="1" max="100">
                        <div id="testing-data-unit-container"></div>
                    </div>
                </div>
                <div class="form-group test-from-group">
                    <label for="testing-data-from">Testing Data From:</label>
                    <div id="testing-data-from-container"></div>
                </div>
            </div>
        </div>

        <div class="model-history card">
            <h3>Model History: <span class="info-icon"><i class="fas fa-info-circle"></i></span></h3>
            <div class="history-controls">
                <button class="minus-button">-</button>
                <span>0</span>
                <button class="plus-button">+</button>
                <span>Versions</span>
                <span class="cost">Cost: 100 tokens per month</span>
            </div>
        </div>

        <div class="processing-units card">
            <h3>Processing Units: <span class="info-icon"><i class="fas fa-microchip"></i></span></h3>
            <div class="history-controls">
                <button class="minus-button">-</button>
                <span>1</span>
                <button class="plus-button">+</button>
                <span>Units</span>
                <span class="gpu-info">GPU: 8GB Memory, 4 Cores</span>
            </div>
        </div>

        <!-- Cost Summary Section -->
        <div class="card cost-calculator">
            <h2>Cost Summary</h2>
            <div class="cost-metrics">
                <div class="metric-row">
                    <div class="metric-item">
                        <i class="fas fa-database"></i>
                        <div>
                            <span class="metric-label">Total Data Size:</span>
                            <span class="metric-value" id="total-data-size">0 MB</span>
                        </div>
                    </div>
                    <div class="metric-item">
                        <i class="fas fa-coins"></i>
                        <div>
                            <span class="metric-label">Total Token Cost:</span>
                            <span class="metric-value" id="total-token-cost">0 tokens</span>
                        </div>
                    </div>
                    <div class="metric-item">
                        <i class="fas fa-chart-line"></i>
                        <div>
                            <span class="metric-label">Predicted Accuracy:</span>
                            <span class="metric-value" id="predicted-accuracy">0%</span>
                        </div>
                    </div>
                    <div class="metric-item">
                        <i class="fas fa-check-circle"></i>
                        <div>
                            <span class="metric-label">Data Quality:</span>
                            <span class="metric-value" id="data-quality">0%</span>
                        </div>
                    </div>
                </div>
                <div class="metric-row">
                    <div class="metric-item">
                        <i class="fas fa-cogs"></i>
                        <div>
                            <span class="metric-label">Model Complexity:</span>
                            <span class="metric-value" id="model-complexity">0%</span>
                        </div>
                    </div>
                    <div class="metric-item">
                        <i class="fas fa-trophy"></i>
                        <div>
                            <span class="metric-label">Model Quality:</span>
                            <span class="metric-value" id="model-quality">0%</span>
                        </div>
                    </div>
                    <div class="metric-item">
                        <i class="fas fa-clock"></i>
                        <div>
                            <span class="metric-label">Training Time:</span>
                            <span class="metric-value" id="training-time">0 min</span>
                        </div>
                    </div>
                    <div class="metric-item">
                        <i class="fas fa-history"></i>
                        <div>
                            <span class="metric-label">Model Versions:</span>
                            <span class="metric-value" id="model-versions">0 versions</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Create Model Button -->
            <div class="cost-summary-actions">
                <button class="auth-button generate-main" id="create-model-btn" onclick="if (window.modelEditorPage) window.modelEditorPage.createModel(); else console.error('Model Editor not loaded yet');">
                    <i class="fas fa-rocket"></i> Create Model
                </button>
            </div>
        </div>
        
        <!-- Enhanced Progress Modal -->
        <div id="progress-modal" class="modal" style="display: none;">
            <div class="modal-content generation-progress">
                <div class="progress-header">
                    <h3>Training Model</h3>
                    <button class="continue-background-btn" id="continue-background">
                        <i class="fas fa-external-link-alt"></i> Continue in Background
                    </button>
                </div>
                
                <!-- Progress Stages -->
                <div class="progress-stages">
                    <div class="stage-item" data-stage="validating">
                        <div class="stage-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <span class="stage-label">Validating</span>
                    </div>
                    <div class="stage-item" data-stage="initializing">
                        <div class="stage-icon">
                            <i class="fas fa-cog"></i>
                        </div>
                        <span class="stage-label">Initializing</span>
                    </div>
                    <div class="stage-item" data-stage="training">
                        <div class="stage-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <span class="stage-label">Training</span>
                    </div>
                    <div class="stage-item" data-stage="evaluating">
                        <div class="stage-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <span class="stage-label">Evaluating</span>
                    </div>
                    <div class="stage-item" data-stage="finalizing">
                        <div class="stage-icon">
                            <i class="fas fa-file-export"></i>
                        </div>
                        <span class="stage-label">Finalizing</span>
                    </div>
                </div>
                
                <!-- Progress Bar -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="generation-progress-fill"></div>
                        <span class="progress-percentage">0%</span>
                    </div>
                </div>
                
                <!-- Progress Details -->
                <div class="progress-details">
                    <div class="progress-stat">
                        <span class="stat-label">Training Progress:</span>
                        <span class="stat-value" id="training-progress">0</span> / <span id="total-epochs">10</span> epochs
                    </div>
                    <div class="progress-stat">
                        <span class="stat-label">Time Elapsed:</span>
                        <span class="stat-value" id="time-elapsed">0:00</span>
                    </div>
                    <div class="progress-stat">
                        <span class="stat-label">ETA:</span>
                        <span class="stat-value" id="eta-remaining">Calculating...</span>
                    </div>
                </div>
                
                <!-- Current Status -->
                <div class="current-status">
                    <p id="status-message">Preparing to train model...</p>
                </div>
                
                <!-- Completion Section (Initially Hidden) -->
                <div class="completion-section" id="completion-section" style="display: none;">
                    <div class="completion-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h4>Model Training Complete!</h4>
                    <p class="completion-message" id="completion-message">
                        Successfully trained model with <span id="final-accuracy">0</span>% accuracy
                    </p>
                    <div class="completion-stats">
                        <div class="stat-item">
                            <i class="fas fa-clock"></i>
                            <span>Total Time: <span id="total-time">0:00</span></span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-database"></i>
                            <span>Model Size: <span id="model-size">0 MB</span></span>
                        </div>
                    </div>
                    <div class="completion-actions">
                        <button class="auth-button download-btn" id="download-model">
                            <i class="fas fa-download"></i> Download Model
                        </button>
                        <button class="secondary-button preview-btn" id="view-metrics">
                            <i class="fas fa-chart-bar"></i> View Metrics
                        </button>
                        <button class="secondary-button close-modal">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
